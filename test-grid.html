<!DOCTYPE html>
<html>
<head>
    <title>Grid Test</title>
</head>
<body>
    <h1>Grid Algorithm Test</h1>
    <div id="output"></div>
    
    <script>
        // Simple grid test
        function testGrid() {
            console.log('=== TESTING GRID ALGORITHM ===');
            
            const images = [
                { width: 50, height: 75, name: 'test1' },
                { width: 50, height: 75, name: 'test2' },
                { width: 50, height: 75, name: 'test3' },
                { width: 50, height: 75, name: 'test4' },
                { width: 50, height: 75, name: 'test5' }
            ];
            
            const pageWidth = 210; // A4 width
            const pageHeight = 297; // A4 height  
            const margin = 10;
            const imageSpacing = 2;
            
            // Calculate usable area
            const usableWidth = pageWidth - (2 * margin);
            const usableHeight = pageHeight - (2 * margin);
            
            console.log('Page:', pageWidth + 'x' + pageHeight + 'mm');
            console.log('Usable area:', usableWidth + 'x' + usableHeight + 'mm');
            
            // Image dimensions with spacing
            const imgW = images[0].width;
            const imgH = images[0].height;
            const effectiveWidth = imgW + imageSpacing;
            const effectiveHeight = imgH + imageSpacing;
            
            console.log('Image size:', imgW + 'x' + imgH + 'mm');
            console.log('Effective size with spacing:', effectiveWidth + 'x' + effectiveHeight + 'mm');
            
            // Calculate grid
            const cols = Math.floor(usableWidth / effectiveWidth);
            const rows = Math.floor(usableHeight / effectiveHeight);
            const imagesPerPage = cols * rows;
            
            console.log('Grid dimensions:', cols + ' cols x ' + rows + ' rows = ' + imagesPerPage + ' slots');
            
            // Place images
            const result = [];
            const maxToPlace = Math.min(images.length, imagesPerPage);
            
            for (let i = 0; i < maxToPlace; i++) {
                const row = Math.floor(i / cols);
                const col = i % cols;
                
                const x = margin + (col * effectiveWidth) + (imageSpacing / 2);
                const y = margin + (row * effectiveHeight) + (imageSpacing / 2);
                
                result.push({
                    ...images[i],
                    x: x,
                    y: y,
                    gridCol: col,
                    gridRow: row
                });
                
                console.log(`Image ${i + 1}: grid[${col},${row}] -> position(${x}, ${y})`);
            }
            
            // Display results
            const output = document.getElementById('output');
            output.innerHTML = `
                <h3>Results:</h3>
                <p><strong>Grid:</strong> ${cols} columns × ${rows} rows = ${imagesPerPage} slots</p>
                <p><strong>Images placed:</strong> ${result.length} out of ${images.length}</p>
                <h4>Positions:</h4>
                <ul>
                    ${result.map(img => `
                        <li>${img.name}: Grid[${img.gridCol},${img.gridRow}] → Position(${img.x}, ${img.y})</li>
                    `).join('')}
                </ul>
            `;
            
            return result;
        }
        
        // Run test
        window.onload = function() {
            testGrid();
        };
    </script>
</body>
</html>
